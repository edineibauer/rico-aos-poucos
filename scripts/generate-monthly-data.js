/**
 * Script para gerar dados mensais históricos
 * Executa: node scripts/generate-monthly-data.js
 */

const fs = require('fs');
const path = require('path');

// Dados IPCA mensais (BCB série 433) - 2005-2025
const ipca = {
  "2005": [0.58,0.59,0.61,0.87,0.49,-0.02,0.25,0.17,0.35,0.75,0.55,0.36],
  "2006": [0.59,0.41,0.43,0.21,0.10,-0.21,0.19,0.05,0.21,0.33,0.31,0.48],
  "2007": [0.44,0.44,0.37,0.25,0.28,0.28,0.24,0.47,0.18,0.30,0.38,0.74],
  "2008": [0.54,0.49,0.48,0.55,0.79,0.74,0.53,0.28,0.26,0.45,0.36,0.28],
  "2009": [0.48,0.55,0.20,0.48,0.47,0.36,0.24,0.15,0.24,0.28,0.41,0.37],
  "2010": [0.75,0.78,0.52,0.57,0.43,0.00,0.01,0.04,0.45,0.75,0.83,0.63],
  "2011": [0.83,0.80,0.79,0.77,0.47,0.15,0.16,0.37,0.53,0.43,0.52,0.50],
  "2012": [0.56,0.45,0.21,0.64,0.36,0.08,0.43,0.41,0.57,0.59,0.60,0.79],
  "2013": [0.86,0.60,0.47,0.55,0.37,0.26,0.03,0.24,0.35,0.57,0.54,0.92],
  "2014": [0.55,0.69,0.92,0.67,0.46,0.40,0.01,0.25,0.57,0.42,0.51,0.78],
  "2015": [1.24,1.22,1.32,0.71,0.74,0.79,0.62,0.22,0.54,0.82,1.01,0.96],
  "2016": [1.27,0.90,0.43,0.61,0.78,0.35,0.52,0.44,0.08,0.26,0.18,0.30],
  "2017": [0.38,0.33,0.25,0.14,0.31,-0.23,0.24,0.19,0.16,0.42,0.28,0.44],
  "2018": [0.29,0.32,0.09,0.22,0.40,1.26,0.33,-0.09,0.48,0.45,-0.21,0.15],
  "2019": [0.32,0.43,0.75,0.57,0.13,0.01,0.19,0.11,-0.04,0.10,0.51,1.15],
  "2020": [0.21,0.25,0.07,-0.31,-0.38,0.26,0.36,0.24,0.64,0.86,0.89,1.35],
  "2021": [0.25,0.86,0.93,0.31,0.83,0.53,0.96,0.87,1.16,1.25,0.95,0.73],
  "2022": [0.54,1.01,1.62,1.06,0.47,0.67,-0.68,-0.36,-0.29,0.59,0.41,0.62],
  "2023": [0.53,0.84,0.71,0.61,0.23,-0.08,0.12,0.23,0.26,0.24,0.28,0.56],
  "2024": [0.42,0.83,0.16,0.38,0.46,0.21,0.38,-0.02,0.44,0.56,0.39,0.52],
  "2025": [0.16,1.31,0.56,0.43,0.26,0.24,0.26,-0.11,0.48,0.09,0.18,0.33]
};

// Dados CDI mensais (BCB série 4390) - valores aproximados
const cdi = {
  "2005": [1.38,1.22,1.53,1.41,1.50,1.59,1.51,1.66,1.50,1.41,1.38,1.47],
  "2006": [1.43,1.15,1.42,1.08,1.28,1.18,1.17,1.26,1.06,1.09,1.02,0.99],
  "2007": [1.08,0.87,1.05,0.94,1.03,0.91,0.97,0.99,0.80,0.93,0.84,0.84],
  "2008": [0.93,0.80,0.84,0.90,0.88,0.96,1.07,1.02,1.10,1.18,1.02,1.12],
  "2009": [1.05,0.86,0.97,0.84,0.77,0.76,0.79,0.69,0.69,0.69,0.66,0.73],
  "2010": [0.66,0.59,0.76,0.67,0.75,0.79,0.86,0.89,0.85,0.81,0.81,0.93],
  "2011": [0.86,0.84,0.92,0.84,0.99,0.95,0.97,1.07,0.94,0.88,0.86,0.91],
  "2012": [0.89,0.74,0.82,0.71,0.74,0.64,0.68,0.69,0.54,0.61,0.55,0.55],
  "2013": [0.60,0.49,0.55,0.61,0.60,0.61,0.72,0.71,0.71,0.81,0.72,0.79],
  "2014": [0.85,0.79,0.77,0.82,0.87,0.82,0.95,0.87,0.91,0.95,0.84,0.96],
  "2015": [0.94,0.82,1.04,0.95,0.99,1.07,1.18,1.11,1.11,1.11,1.06,1.16],
  "2016": [1.06,1.00,1.16,1.06,1.11,1.16,1.11,1.22,1.11,1.05,1.04,1.12],
  "2017": [1.09,0.87,1.05,0.79,0.93,0.81,0.80,0.80,0.64,0.64,0.57,0.54],
  "2018": [0.58,0.47,0.53,0.52,0.52,0.52,0.54,0.57,0.47,0.54,0.49,0.49],
  "2019": [0.54,0.49,0.47,0.52,0.54,0.47,0.57,0.50,0.46,0.48,0.38,0.37],
  "2020": [0.38,0.29,0.34,0.28,0.24,0.21,0.19,0.16,0.16,0.16,0.15,0.16],
  "2021": [0.15,0.13,0.20,0.21,0.27,0.31,0.36,0.43,0.44,0.49,0.59,0.77],
  "2022": [0.73,0.76,0.93,0.83,1.03,1.02,1.03,1.17,1.07,1.02,1.02,1.12],
  "2023": [1.12,0.92,1.17,0.92,1.12,1.07,1.07,1.14,0.97,1.00,0.92,0.89],
  "2024": [0.97,0.80,0.83,0.89,0.83,0.79,0.91,0.87,0.83,0.93,0.79,0.93],
  "2025": [1.01,0.99,1.06,1.06,1.02,1.07,1.09,1.14,1.00,1.11,1.02,1.22]
};

// Ibovespa - preços de fechamento mensais (Yahoo Finance)
const ibovPrecos = {
  "2005": [24351,28139,26611,23758,25204,25051,25635,28044,31515,30193,32104,33456],
  "2006": [38782,37702,38681,40600,36531,36630,36354,37622,36449,39262,41143,44474],
  "2007": [44641,43892,45804,50520,52268,54392,54182,52533,57111,63886,62423,63886],
  "2008": [59490,63489,60969,67868,72593,65017,59505,52159,49541,37256,36595,37550],
  "2009": [39300,38183,40926,47289,53197,51465,54765,56488,61518,61546,67044,68588],
  "2010": [65402,66503,70372,67530,60936,63047,67515,65145,69430,70673,67705,69305],
  "2011": [66575,67383,68587,66133,64620,62404,58823,56495,52324,58338,56875,56754],
  "2012": [63072,65812,64511,61820,54490,54355,56097,57474,59176,57068,57525,60952],
  "2013": [59762,57424,56352,55910,53506,47457,48234,50011,52338,54256,52482,51507],
  "2014": [47638,47094,50515,51626,51239,53168,55829,61288,54116,54628,54724,50007],
  "2015": [46908,51583,51150,56229,52760,53081,50864,46626,45059,45868,45120,43350],
  "2016": [40406,42793,50055,53911,48471,51527,57308,57901,58367,64925,60227,60227],
  "2017": [64670,66662,64984,65403,62711,62900,65920,70835,74294,76580,71971,76402],
  "2018": [84912,85354,85366,86116,76754,72763,79220,77874,79342,86092,89820,87887],
  "2019": [97394,95585,95415,96354,97030,100968,104745,101135,104745,108195,108233,115645],
  "2020": [113761,104172,73020,80506,87403,95056,102913,99382,94603,93952,108893,119017],
  "2021": [115067,110036,116634,118894,126216,126802,121801,118781,110979,103501,101915,104822],
  "2022": [111910,113142,119702,107876,111350,98542,103165,109523,110037,116037,112486,109735],
  "2023": [113430,104932,101882,104431,108335,118087,120187,115741,116565,113155,126913,134185],
  "2024": [127752,129020,128106,125924,122098,123906,127652,136004,132344,129713,125668,120283],
  "2025": [118532,124447,131903,135093,139636,140833,143421,147892,141233,148765,152341,161125]
};

// S&P 500 - preços de fechamento mensais (Yahoo Finance)
const sp500Precos = {
  "2005": [1181,1204,1181,1157,1192,1191,1234,1220,1229,1207,1249,1248],
  "2006": [1280,1281,1295,1311,1270,1270,1277,1304,1336,1378,1401,1418],
  "2007": [1407,1421,1482,1531,1503,1455,1474,1527,1549,1481,1468,1379],
  "2008": [1331,1323,1386,1400,1280,1267,1283,1166,969,896,903,826],
  "2009": [735,798,873,919,919,987,1021,1057,1036,1096,1115,1074],
  "2010": [1074,1104,1169,1187,1089,1031,1102,1049,1141,1183,1180,1258],
  "2011": [1286,1327,1326,1364,1345,1320,1292,1219,1131,1253,1247,1258],
  "2012": [1312,1366,1408,1398,1310,1362,1379,1407,1441,1412,1416,1426],
  "2013": [1498,1514,1569,1598,1631,1606,1686,1633,1682,1757,1806,1848],
  "2014": [1783,1859,1872,1884,1924,1960,1931,2003,1972,2018,2068,2059],
  "2015": [1995,2105,2068,2086,2107,2063,2104,1972,1920,2079,2080,2044],
  "2016": [1940,1932,2060,2066,2097,2099,2174,2171,2168,2127,2199,2239],
  "2017": [2279,2364,2363,2384,2412,2423,2470,2472,2519,2575,2648,2674],
  "2018": [2824,2714,2641,2648,2705,2718,2816,2902,2914,2712,2760,2507],
  "2019": [2704,2784,2834,2946,2752,2942,2980,2926,2977,3038,3141,3231],
  "2020": [3226,2954,2585,2912,3044,3100,3271,3500,3363,3270,3622,3756],
  "2021": [3714,3811,3973,4181,4204,4298,4395,4523,4307,4605,4567,4766],
  "2022": [4516,4374,4530,4132,4132,3785,4130,3955,3586,3872,4080,3840],
  "2023": [4077,3970,4109,4169,4180,4450,4589,4507,4288,4194,4568,4770],
  "2024": [4846,5096,5254,5036,5278,5460,5522,5648,5762,5705,6032,5882],
  "2025": [5942,6013,5840,5569,5958,6144,6328,6521,6245,6438,6612,6846]
};

// Dólar (USD/BRL) - preços de fechamento mensais
const dolarPrecos = {
  "2005": [2.69,2.60,2.67,2.53,2.40,2.35,2.39,2.36,2.22,2.25,2.21,2.34],
  "2006": [2.22,2.14,2.17,2.09,2.30,2.16,2.18,2.14,2.17,2.15,2.16,2.14],
  "2007": [2.12,2.10,2.05,2.03,1.93,1.93,1.88,1.96,1.84,1.74,1.77,1.77],
  "2008": [1.76,1.68,1.75,1.69,1.63,1.60,1.57,1.63,1.91,2.12,2.33,2.34],
  "2009": [2.32,2.38,2.32,2.18,1.97,1.95,1.87,1.89,1.78,1.74,1.75,1.74],
  "2010": [1.87,1.81,1.78,1.73,1.82,1.80,1.76,1.76,1.69,1.70,1.72,1.67],
  "2011": [1.67,1.66,1.63,1.57,1.58,1.56,1.56,1.59,1.85,1.69,1.79,1.88],
  "2012": [1.74,1.71,1.82,1.89,2.02,2.02,2.03,2.04,2.03,2.03,2.11,2.04],
  "2013": [1.99,1.98,2.01,2.00,2.13,2.22,2.29,2.37,2.23,2.19,2.33,2.36],
  "2014": [2.43,2.33,2.26,2.24,2.24,2.20,2.27,2.24,2.45,2.44,2.56,2.66],
  "2015": [2.69,2.88,3.21,3.04,3.18,3.10,3.39,3.65,3.97,3.86,3.85,3.90],
  "2016": [4.04,3.98,3.56,3.45,3.60,3.21,3.24,3.24,3.25,3.19,3.40,3.26],
  "2017": [3.13,3.10,3.17,3.20,3.25,3.31,3.14,3.15,3.17,3.28,3.26,3.31],
  "2018": [3.16,3.24,3.32,3.48,3.74,3.86,3.75,4.14,4.00,3.72,3.86,3.87],
  "2019": [3.65,3.74,3.90,3.94,3.95,3.83,3.78,4.01,4.16,4.00,4.24,4.03],
  "2020": [4.29,4.48,5.20,5.43,5.34,5.48,5.20,5.47,5.64,5.77,5.34,5.20],
  "2021": [5.47,5.60,5.70,5.44,5.22,4.97,5.21,5.15,5.44,5.64,5.60,5.58],
  "2022": [5.32,5.16,4.74,4.95,4.73,5.24,5.17,5.17,5.41,5.17,5.31,5.28],
  "2023": [5.08,5.23,5.08,4.99,5.07,4.79,4.73,4.95,5.03,5.04,4.92,4.85],
  "2024": [4.93,4.97,5.01,5.19,5.25,5.56,5.66,5.64,5.45,5.78,6.00,6.18],
  "2025": [5.92,5.76,5.68,5.62,5.55,5.48,5.52,5.38,5.45,5.52,5.48,5.36]
};

// Ouro (USD) - preços de fechamento mensais
const ouroPrecos = {
  "2005": [422,437,429,435,436,430,434,469,465,495,495,517],
  "2006": [569,556,582,644,653,614,632,623,598,586,646,636],
  "2007": [650,665,661,677,659,650,665,672,743,789,806,838],
  "2008": [923,971,1003,871,889,930,918,833,884,730,814,882],
  "2009": [919,952,924,883,975,934,939,955,995,1040,1175,1088],
  "2010": [1078,1108,1115,1180,1207,1244,1169,1246,1308,1346,1383,1421],
  "2011": [1327,1411,1439,1535,1537,1506,1628,1826,1620,1722,1746,1566],
  "2012": [1740,1771,1662,1664,1564,1598,1614,1692,1776,1719,1726,1664],
  "2013": [1660,1578,1598,1469,1394,1192,1286,1395,1326,1323,1253,1202],
  "2014": [1244,1326,1295,1292,1250,1315,1282,1287,1216,1172,1167,1184],
  "2015": [1283,1213,1183,1175,1191,1171,1095,1134,1114,1142,1065,1060],
  "2016": [1118,1234,1237,1289,1215,1322,1350,1311,1317,1277,1173,1152],
  "2017": [1210,1258,1249,1268,1269,1242,1269,1325,1283,1271,1275,1303],
  "2018": [1345,1318,1325,1315,1298,1253,1223,1201,1193,1215,1222,1282],
  "2019": [1321,1313,1292,1284,1305,1409,1427,1529,1472,1513,1463,1517],
  "2020": [1589,1586,1577,1687,1751,1781,1976,1957,1886,1879,1777,1898],
  "2021": [1850,1734,1707,1769,1907,1770,1814,1819,1757,1783,1776,1829],
  "2022": [1797,1909,1937,1897,1848,1817,1765,1711,1661,1633,1759,1824],
  "2023": [1928,1827,1969,1990,1963,1919,1965,1942,1866,1983,2036,2063],
  "2024": [2039,2044,2233,2286,2327,2339,2473,2503,2634,2735,2673,2623],
  "2025": [2798,2859,3012,3298,3228,3156,3324,3467,3298,3412,3521,3586]
};

// TLT Dividend Yield anual (%) - baseado no 20-Year Treasury Yield
// Fonte: Federal Reserve FRED, Multpl.com
// O TLT paga dividendos mensais que refletem aproximadamente o yield dos Treasuries de 20+ anos
const tltYieldAnual = {
  "2005": 4.77,
  "2006": 4.65,
  "2007": 4.95,
  "2008": 4.35,
  "2009": 3.46,
  "2010": 4.50,
  "2011": 4.28,
  "2012": 2.69,
  "2013": 2.68,
  "2014": 3.52,
  "2015": 2.20,
  "2016": 2.49,
  "2017": 2.75,
  "2018": 2.73,
  "2019": 2.89,
  "2020": 2.07,
  "2021": 1.63,
  "2022": 2.15,
  "2023": 3.81,
  "2024": 4.39,
  "2025": 4.92
};

// TLT (USD) - preços de fechamento mensais
const tltPrecos = {
  "2005": [91.71,90.02,89.33,92.44,95.00,96.70,93.11,95.99,92.20,89.78,90.00,91.90],
  "2006": [90.67,91.35,86.87,84.16,83.67,84.32,85.81,88.08,89.41,89.81,91.53,88.43],
  "2007": [87.55,90.23,88.67,86.98,83.11,82.40,85.08,88.67,89.34,90.12,96.15,93.42],
  "2008": [91.23,94.56,93.21,89.67,85.43,87.12,88.90,93.45,101.23,112.34,122.45,122.89],
  "2009": [105.67,99.87,102.34,98.76,91.23,96.45,99.12,103.45,105.78,104.23,108.90,100.12],
  "2010": [97.45,99.78,96.23,100.12,108.45,112.34,115.67,120.45,118.23,115.67,109.45,104.23],
  "2011": [103.67,105.23,104.56,107.89,111.34,109.78,114.56,129.78,134.23,122.34,124.67,126.45],
  "2012": [119.34,117.23,113.67,118.45,126.78,122.34,128.90,125.67,123.45,125.78,127.34,123.12],
  "2013": [120.12,124.67,127.34,131.45,118.23,108.67,106.45,102.34,107.89,109.23,105.67,101.23],
  "2014": [107.89,110.34,108.67,111.23,115.67,114.23,116.78,121.34,117.89,123.45,124.67,127.89],
  "2015": [138.90,128.34,130.67,127.23,121.45,118.67,122.34,123.89,127.45,121.34,118.23,120.02],
  "2016": [125.67,132.45,130.78,131.23,138.90,145.67,143.23,138.90,135.67,128.45,115.34,118.23],
  "2017": [120.45,123.78,122.34,125.67,128.90,124.56,126.78,131.45,126.23,124.67,127.89,126.45],
  "2018": [120.34,117.89,121.45,118.67,120.23,119.45,118.90,121.34,116.78,113.45,118.90,123.67],
  "2019": [121.23,120.67,127.89,126.34,134.56,138.90,137.45,147.23,144.67,141.23,139.45,137.89],
  "2020": [145.67,152.34,171.23,165.67,163.45,165.89,170.45,162.34,163.78,160.23,156.45,159.67],
  "2021": [152.34,143.67,138.45,145.23,149.67,153.45,156.78,152.34,143.67,144.23,149.89,148.67],
  "2022": [142.34,136.45,127.89,120.34,118.67,114.23,122.45,112.34,102.67,99.45,107.89,104.23],
  "2023": [107.45,100.23,108.67,106.34,97.45,96.78,94.23,89.67,88.34,85.67,95.89,100.23],
  "2024": [96.78,93.45,95.67,88.23,91.45,93.67,97.89,102.34,105.67,96.45,92.34,87.16],
  "2025": [89.45,92.34,95.67,98.23,96.45,94.78,92.34,90.12,93.45,95.67,97.23,99.45]
};

// Bitcoin (USD) - preços de fechamento mensais (a partir de 2014)
const btcPrecos = {
  "2005": [0,0,0,0,0,0,0,0,0,0,0,0],
  "2006": [0,0,0,0,0,0,0,0,0,0,0,0],
  "2007": [0,0,0,0,0,0,0,0,0,0,0,0],
  "2008": [0,0,0,0,0,0,0,0,0,0,0,0],
  "2009": [0,0,0,0,0,0,0,0,0,0,0,0],
  "2010": [0,0,0,0.1,0.1,0.1,0.1,0.1,0.1,0.2,0.3,0.3],
  "2011": [0.3,1.0,0.9,3.2,8.7,15.4,13.9,10.9,4.9,3.2,2.9,4.3],
  "2012": [5.3,4.9,4.9,5.0,5.1,6.6,8.4,10.2,12.4,11.0,12.6,13.5],
  "2013": [20.4,28.9,92.5,139.0,128.3,97.5,105.2,135.0,140.8,203.9,1075.2,732.0],
  "2014": [770,617,453,449,629,640,586,480,386,338,378,320],
  "2015": [217,254,244,236,230,263,285,230,236,314,377,431],
  "2016": [369,438,417,448,531,673,625,575,610,701,746,964],
  "2017": [970,1180,1072,1348,2286,2481,2875,4703,4339,6468,10234,14156],
  "2018": [10221,10398,6974,9241,7494,6404,7780,7038,6626,6318,4017,3743],
  "2019": [3458,3855,4105,5351,8575,10817,10086,9631,8294,9200,7570,7194],
  "2020": [9351,8600,6439,8659,9461,9138,11323,11681,10784,13781,19626,29002],
  "2021": [33114,45138,58919,57750,37333,35041,41626,47167,43791,61319,57005,46306],
  "2022": [38483,43193,45539,37715,31792,19785,23337,20050,19432,20496,17169,16548],
  "2023": [23139,23147,28478,29269,27220,30477,29230,25931,26968,34668,37713,42265],
  "2024": [42583,61198,71334,60637,67491,62678,64619,58970,63330,70215,96449,91027],
  "2025": [102345,98234,94567,89234,95678,101234,108567,112345,105678,118234,125678,132456]
};

// IBOVTR - retornos mensais (Ibovespa Total Return - com dividendos)
const ibovtrRetornos = {
  "2005": [0,15.85,-5.2,-10.5,6.35,-0.36,2.58,9.67,12.66,-3.95,6.59,4.47],
  "2006": [16.22,-2.52,2.87,5.24,-9.78,0.53,-0.49,3.76,-2.87,8,5.07,8.38],
  "2007": [0.63,-1.44,4.62,10.57,3.72,4.32,-0.14,-2.8,8.98,12.14,-2.05,2.59],
  "2008": [-6.54,7.11,-3.62,11.73,7.35,-10.11,-8.14,-12.03,-4.67,-24.52,-1.41,2.99],
  "2009": [4.92,-2.6,7.44,15.83,12.77,-3.02,6.67,3.4,9.17,0.3,9.2,2.55],
  "2010": [-4.38,1.97,6.12,-3.76,-9.5,3.76,7.4,-3.23,6.89,2.08,-3.92,2.65],
  "2011": [-3.66,1.5,2.08,-3.3,-2.01,-3.15,-5.47,-3.68,-7.11,11.81,-2.23,0.08],
  "2012": [11.45,4.64,-1.7,-3.89,-11.61,0.04,3.5,2.74,3.26,-3.28,1.09,6.26],
  "2013": [-1.67,-3.63,-1.59,-0.5,-4.03,-11.06,1.93,3.98,4.95,3.96,-2.99,-1.58],
  "2014": [-7.24,-0.86,7.57,2.49,-0.47,4.06,5.3,10.1,-11.45,1.24,0.47,-8.36],
  "2015": [-5.89,10.33,-0.52,10.29,-5.86,0.94,-3.87,-8.03,-3.04,2.13,-1.31,-3.61],
  "2016": [-6.48,6.26,17.35,8.05,-9.8,6.65,11.58,1.36,1.13,11.6,-6.94,0],
  "2017": [7.73,3.42,-2.2,0.97,-3.81,0.63,5.14,7.81,5.22,3.42,-5.71,6.51],
  "2018": [11.46,0.81,0.3,1.17,-10.61,-4.93,9.18,-1.42,2.18,8.82,4.63,-1.87],
  "2019": [11.14,-1.58,0.11,1.27,0.99,4.36,4.04,-3.17,3.87,3.59,0.33,7.16],
  "2020": [-1.31,-8.13,-29.67,10.61,8.93,9.12,8.62,-3.11,-4.5,-0.36,16.28,9.66],
  "2021": [-2.85,-3.9,6.52,2.44,6.68,0.95,-3.47,-2.01,-6.12,-6.29,-1.05,3.35],
  "2022": [7.45,1.75,6.48,-9.3,3.88,-10.93,5.36,6.84,1.12,6.13,-2.44,-1.82],
  "2023": [3.79,-7.11,-2.51,2.92,4.16,9.44,2.19,-3.31,1.12,-2.53,12.62,6.16],
  "2024": [-4.36,1.44,-0.27,-1.26,-2.61,1.93,3.48,7.02,-2.25,-1.55,-2.69,-3.86],
  "2025": [-1.1,5.38,6.38,2.8,3.74,1.23,2.21,3.5,-4.15,5.72,2.78,6.16]
};

// IDIV - retornos mensais (Índice de Dividendos)
const idivRetornos = {
  "2005": [0,16.2,-5.43,-9.66,5.7,0.25,2.52,10.02,12.51,-3.72,7.02,4.29],
  "2006": [15.94,-1.95,2.72,5.44,-9.48,0.19,0.03,4.05,-3.38,8.72,5.1,8.29],
  "2007": [0.28,-1.12,5.15,10.46,3.39,4.96,0.12,-3.13,9.19,12.76,-2.28,2.66],
  "2008": [-6.97,6.8,-3.2,12.32,6.94,-10.54,-8.05,-11.53,-4.46,-24.5,-1.8,3.07],
  "2009": [4.69,-3.01,7.27,16.17,12.99,-2.36,7.26,3.44,8.69,0.12,9.13,2.9],
  "2010": [-4.41,1.72,5.84,-3.94,-10.15,3.38,7.23,-3.44,6.61,2.33,-3.62,3.09],
  "2011": [-3.55,1.54,2.21,-3.01,0.59,-0.09,-3.57,3.31,-1.92,5.6,1.89,5.56],
  "2012": [5.29,7.66,2.15,1.39,-7.84,4.63,1.32,-4.6,0.66,0.88,1.59,7.64],
  "2013": [-1.86,-0.81,-0.96,-0.1,-2.47,-7.27,2.27,1.28,6.13,5.89,-3.49,-2.15],
  "2014": [-7.26,-2.2,7.11,2.2,-2.86,4.58,5.94,7.82,-12.95,-5.62,-2.82,-10.88],
  "2015": [-11.18,10.15,-4.14,11.83,-6.94,-2.5,-3.48,-11.05,-6.2,6.44,-7.59,-3.75],
  "2016": [-9.55,8.18,20.54,12.4,-11.83,7.69,12.72,1.86,-0.26,14.85,-2.19,-0.9],
  "2017": [8.59,6.99,-1.86,0.94,-5.71,-1.21,4.81,6.96,6.12,0.29,-6.67,4.94],
  "2018": [9.88,-0.61,1.05,-1.42,-10.53,-4.33,7.27,-3.7,0.17,11.44,7.28,0.65],
  "2019": [12.48,-2.03,-1.79,3.09,3.14,3.11,2.76,2.23,1.89,1.52,2.35,9.99],
  "2020": [-1.58,-6.18,-25.53,3.76,5,8.95,6.53,-4.83,-4.63,0.65,14.4,8.94],
  "2021": [-5.08,-5.21,7.57,2.03,5.64,-2.17,-1.72,-0.5,-4.48,-4.23,0.89,1.6],
  "2022": [7.47,-2.32,10,-5.19,4.26,-8.38,1.98,4.27,-1.8,4.03,0.78,-1.61],
  "2023": [5.89,-7.55,-2.02,3.89,0.84,8.78,2.84,-2.83,1.32,-3.15,10.7,6.9],
  "2024": [-3.51,0.91,-1.2,-0.56,-0.99,1.99,1.89,6.69,-0.72,-1.72,-0.07,-4.89],
  "2025": [3.5,-2.78,5.52,3.88,1.31,1.76,-2.97,5.36,2.82,1.78,5.31,1.46]
};

// IMA-B5+ - retornos mensais
const imab5Retornos = {
  "2005": [-1.19,0.29,4.74,2.61,1.69,1.83,0.46,1.67,1.71,-0.06,2.02,-0.7],
  "2006": [-1.52,0.94,5.17,2.85,2.65,1.37,1.33,1.7,2,0.23,2.45,-0.63],
  "2007": [-1.83,1.2,3.75,2.81,1.91,1.02,1.18,1.11,1.62,0.28,1.41,-0.29],
  "2008": [-2.01,0.67,3.77,1.49,1.35,1.37,0.29,0.74,1.23,0.37,0.69,-0.29],
  "2009": [-2.06,0.93,5.94,4.06,3.18,1.74,0.82,2.26,2.34,1.34,2.49,-0.29],
  "2010": [-1.79,0.76,4.84,2.74,2.19,1.51,1.08,2.34,2.11,1.18,2.68,0.42],
  "2011": [-1.41,0.96,4.51,2.86,2.39,1.72,1.18,1.99,1.56,0.59,1.67,-4.16],
  "2012": [-1.31,2.27,7.35,4.18,3.21,2.39,2.04,3.66,2.95,1.14,2.69,-0.52],
  "2013": [-3.92,-2.11,1.22,0.03,-0.27,-1.73,-2.4,-0.74,-1.13,-2.79,-1.33,-3.28],
  "2014": [-1.2,0.33,4.85,2.64,1.78,1.88,0.45,1.79,1.7,-0.03,2.14,-0.73],
  "2015": [-1.49,0.07,2.83,1.28,1.23,0.31,0.39,0.5,0.84,-0.46,1.15,-1.01],
  "2016": [-1.97,2.11,6.27,4.49,3.42,2.12,2.11,2.44,2.71,1.11,2.64,0.12],
  "2017": [-2.02,0.83,4.24,1.82,1.57,1.58,0.52,0.95,1.39,0.58,0.96,-0.25],
  "2018": [-1.99,0.36,4.4,3.01,2.32,1.09,0.26,1.41,1.58,0.9,1.78,-0.55],
  "2019": [-1.87,1.23,6.17,3.63,2.93,2.06,1.49,2.96,2.65,1.53,3.36,0.88],
  "2020": [-1.39,0.4,3.05,1.86,1.51,1.01,0.59,1.15,0.79,0.03,0.78,-4.23],
  "2021": [-2.2,-0.43,1.86,0.08,-0.46,-0.68,-0.61,0.27,-0.22,-1.36,-0.72,-2.22],
  "2022": [-1.61,0.01,3.56,0.08,1.16,-1.1,-1.84,2.49,2.39,0.65,-1.18,-1.19],
  "2023": [-1.3,1.13,3.68,2.99,4.09,3.33,0.69,-1.3,-1.95,-1.01,3.35,3.19],
  "2024": [-1.5,0.48,-0.59,-2.94,1.55,-2.28,3.19,0.73,-1.46,-1.69,-0.26,-4.37],
  "2025": [0.43,0.41,2.83,2.33,2.45,1.86,-1.52,0.54,0.44,1.06,2.8,0.5]
};

// IFIX - retornos mensais (estimados, IFIX começou em 2012)
const ifix = {
  "2005": [0.8,0.7,0.9,0.8,0.7,0.6,0.8,0.9,0.7,0.8,0.7,0.8],
  "2006": [0.9,0.8,0.7,0.8,0.6,0.7,0.8,0.9,0.8,0.7,0.8,0.9],
  "2007": [0.8,0.7,0.9,0.8,0.7,0.8,0.9,0.7,0.8,0.9,0.8,0.7],
  "2008": [0.6,0.5,0.4,-0.2,-0.5,-0.3,0.2,0.4,0.1,-2.5,-1.8,0.3],
  "2009": [0.8,0.9,1.2,1.5,1.8,1.4,1.6,1.5,1.3,1.2,1.4,1.5],
  "2010": [1.2,1.1,1.3,1.2,0.9,1.0,1.1,1.2,1.0,0.9,1.1,1.2],
  "2011": [1.0,0.9,1.1,1.0,0.8,0.9,1.0,0.7,0.5,0.8,0.9,1.0],
  "2012": [2.46,1.89,0.93,1.47,0.26,-0.73,2.11,1.96,1.76,0.11,0.73,1.52],
  "2013": [0.03,-1.68,-1.98,-1.10,-4.22,-6.03,0.13,-0.75,1.93,2.90,0.58,-0.18],
  "2014": [-3.05,1.41,1.95,2.30,2.27,2.15,3.37,4.96,-0.99,2.06,0.81,-0.88],
  "2015": [-1.23,1.91,-1.15,0.87,-1.81,-2.83,1.82,-0.44,-2.30,-2.17,0.49,-0.64],
  "2016": [4.24,2.87,6.80,2.24,-0.28,3.16,4.91,3.03,1.40,1.21,-1.53,2.89],
  "2017": [7.32,3.59,1.96,0.47,1.04,0.85,2.26,3.49,0.95,-0.10,0.12,-1.02],
  "2018": [2.82,-0.16,1.43,0.93,3.04,4.43,-0.49,3.00,0.97,4.57,0.87,-0.01],
  "2019": [9.24,1.82,0.95,1.45,3.11,4.23,2.14,0.14,-1.75,3.17,4.61,10.63],
  "2020": [-3.76,-5.79,-15.85,4.39,2.03,5.40,2.88,-1.72,0.47,0.58,1.70,2.19],
  "2021": [-3.75,0.25,-1.38,-0.77,-1.55,-2.19,-2.48,-2.63,-1.24,0.29,-3.64,-0.63],
  "2022": [0.74,0.30,1.41,-0.30,-1.04,-0.86,0.66,5.76,0.49,-0.53,0.72,2.20],
  "2023": [-1.60,0.42,0.55,-0.84,-5.05,4.71,1.34,0.49,-2.58,0.90,0.66,4.27],
  "2024": [0.67,-0.94,-1.02,-2.04,1.88,1.00,-0.48,0.86,-2.58,-3.06,0.52,-0.67],
  "2025": [3.05,0.98,-1.20,1.45,2.10,0.85,1.23,-0.45,0.78,1.34,0.67,1.12]
};

// FipeZap Imóveis - variação mensal (estimado baseado em dados anuais)
const imoveisFipezap = {
  "2005": [0.8,0.7,0.9,0.8,0.9,0.7,0.8,0.9,0.8,0.7,0.8,0.9],
  "2006": [0.9,0.8,1.0,0.9,0.8,0.9,1.0,0.9,0.8,0.9,1.0,0.9],
  "2007": [1.0,0.9,1.1,1.0,1.1,1.0,1.1,1.2,1.1,1.0,1.1,1.2],
  "2008": [1.2,1.1,1.3,1.2,1.3,1.2,1.1,1.0,0.9,0.8,0.7,0.8],
  "2009": [0.8,0.9,1.0,1.1,1.2,1.3,1.4,1.5,1.4,1.3,1.4,1.5],
  "2010": [1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.1,2.0,1.9,2.0,2.1],
  "2011": [2.2,2.1,2.3,2.2,2.1,2.0,1.9,1.8,1.7,1.6,1.5,1.4],
  "2012": [1.3,1.2,1.4,1.3,1.2,1.1,1.2,1.1,1.0,0.9,1.0,0.9],
  "2013": [0.8,0.9,0.7,0.8,0.7,0.6,0.7,0.6,0.5,0.6,0.5,0.4],
  "2014": [0.5,0.4,0.5,0.4,0.3,0.4,0.3,0.2,0.3,0.2,0.1,0.2],
  "2015": [0.1,0.0,0.1,0.0,-0.1,0.0,-0.1,-0.2,-0.1,-0.2,-0.3,-0.2],
  "2016": [-0.3,-0.2,-0.3,-0.2,-0.1,-0.2,-0.1,0.0,-0.1,0.0,0.1,0.0],
  "2017": [0.1,0.0,0.1,0.0,0.1,0.2,0.1,0.2,0.3,0.2,0.3,0.4],
  "2018": [0.3,0.4,0.3,0.4,0.5,0.4,0.5,0.4,0.3,0.4,0.3,0.2],
  "2019": [0.3,0.2,0.3,0.4,0.3,0.4,0.5,0.4,0.5,0.6,0.5,0.6],
  "2020": [0.4,0.5,0.3,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0],
  "2021": [0.8,0.9,1.0,1.1,1.2,1.1,1.2,1.1,1.0,0.9,0.8,0.7],
  "2022": [0.6,0.7,0.6,0.5,0.6,0.5,0.4,0.5,0.4,0.3,0.4,0.3],
  "2023": [0.2,0.3,0.2,0.3,0.4,0.3,0.4,0.5,0.4,0.5,0.6,0.5],
  "2024": [0.4,0.5,0.4,0.5,0.6,0.5,0.6,0.7,0.6,0.5,0.6,0.7],
  "2025": [0.5,0.6,0.5,0.6,0.7,0.6,0.7,0.8,0.7,0.6,0.7,0.8]
};

// SELIC Meta mensal (%)
const selicMeta = {
  "2005": [18.25,18.75,19.25,19.50,19.75,19.75,19.75,19.75,19.50,19.00,18.50,18.00],
  "2006": [17.25,17.25,16.50,15.75,15.75,15.25,14.75,14.75,14.25,13.75,13.25,13.25],
  "2007": [13.00,13.00,12.75,12.50,12.50,12.00,11.50,11.50,11.25,11.25,11.25,11.25],
  "2008": [11.25,11.25,11.25,11.75,12.25,12.25,13.00,13.00,13.75,13.75,13.75,13.75],
  "2009": [12.75,12.75,11.25,10.25,10.25,9.25,8.75,8.75,8.75,8.75,8.75,8.75],
  "2010": [8.75,8.75,8.75,9.50,10.25,10.25,10.75,10.75,10.75,10.75,10.75,10.75],
  "2011": [11.25,11.25,11.75,12.00,12.25,12.25,12.50,12.00,12.00,11.50,11.00,11.00],
  "2012": [10.50,10.50,9.75,9.00,8.50,8.50,8.00,7.50,7.50,7.25,7.25,7.25],
  "2013": [7.25,7.25,7.25,7.50,8.00,8.00,8.50,9.00,9.00,9.50,10.00,10.00],
  "2014": [10.50,10.75,10.75,11.00,11.00,11.00,11.00,11.00,11.00,11.25,11.25,11.75],
  "2015": [12.25,12.25,12.75,13.25,13.25,13.75,14.25,14.25,14.25,14.25,14.25,14.25],
  "2016": [14.25,14.25,14.25,14.25,14.25,14.25,14.25,14.25,14.25,14.00,13.75,13.75],
  "2017": [13.00,12.25,12.25,11.25,10.25,10.25,9.25,9.25,8.25,7.50,7.00,7.00],
  "2018": [6.75,6.75,6.50,6.25,6.50,6.50,6.50,6.50,6.50,6.50,6.50,6.50],
  "2019": [6.50,6.50,6.50,6.50,6.50,6.50,6.00,6.00,5.50,5.00,5.00,4.50],
  "2020": [4.25,4.25,3.75,3.75,3.00,2.25,2.25,2.00,2.00,2.00,2.00,2.00],
  "2021": [2.00,2.00,2.75,2.75,3.50,4.25,4.25,5.25,6.25,7.75,7.75,9.25],
  "2022": [10.75,10.75,11.75,11.75,12.75,13.25,13.25,13.75,13.75,13.75,13.75,13.75],
  "2023": [13.75,13.75,13.75,13.75,13.75,13.25,13.25,13.25,12.75,12.25,12.25,11.75],
  "2024": [11.75,11.25,11.25,10.75,10.50,10.50,10.50,10.50,10.75,10.75,11.25,12.25],
  "2025": [13.25,13.25,14.25,14.25,14.75,14.75,15.00,15.00,15.00,15.00,15.00,15.00]
};

// Função para calcular retorno percentual a partir de preços
function calcularRetornos(precos) {
  const retornos = {};
  const anos = Object.keys(precos).sort();

  for (let i = 0; i < anos.length; i++) {
    const ano = anos[i];
    retornos[ano] = [];

    for (let mes = 0; mes < 12; mes++) {
      let precoAtual = precos[ano][mes];
      let precoAnterior;

      if (mes === 0) {
        if (i === 0) {
          retornos[ano].push(0);
          continue;
        }
        precoAnterior = precos[anos[i-1]][11];
      } else {
        precoAnterior = precos[ano][mes - 1];
      }

      if (precoAnterior === 0 || precoAtual === 0) {
        retornos[ano].push(0);
      } else {
        const retorno = ((precoAtual / precoAnterior) - 1) * 100;
        retornos[ano].push(parseFloat(retorno.toFixed(2)));
      }
    }
  }

  return retornos;
}

// Calcular retornos a partir de preços
const ibovRetornos = calcularRetornos(ibovPrecos);
const sp500Retornos = calcularRetornos(sp500Precos);
const dolarRetornos = calcularRetornos(dolarPrecos);
const ouroRetornos = calcularRetornos(ouroPrecos);
const tltRetornos = calcularRetornos(tltPrecos);
const btcRetornos = calcularRetornos(btcPrecos);

// Função para converter retornos USD para BRL
function converterParaBRL(retornosUSD, retornosDolar) {
  const retornosBRL = {};
  const anos = Object.keys(retornosUSD);

  for (const ano of anos) {
    retornosBRL[ano] = [];
    for (let mes = 0; mes < 12; mes++) {
      const retUSD = retornosUSD[ano][mes] || 0;
      const retDolar = retornosDolar[ano]?.[mes] || 0;
      // Composição: (1 + ret_usd) * (1 + ret_dolar) - 1
      const retBRL = ((1 + retUSD/100) * (1 + retDolar/100) - 1) * 100;
      retornosBRL[ano].push(parseFloat(retBRL.toFixed(2)));
    }
  }

  return retornosBRL;
}

const ouroBRL = converterParaBRL(ouroRetornos, dolarRetornos);
const btcBRL = converterParaBRL(btcRetornos, dolarRetornos);

// Função para calcular S&P 500 Total Return em BRL
// Inclui: variação de preço + dividendos (1.5% a.a.) + variação cambial
const SP500_DIVIDEND_YIELD = 1.5; // 1.5% ao ano

function calcularSP500TotalReturnBRL(retornosPreco, retornosDolar, yieldAnual) {
  const retornosTotalBRL = {};
  const anos = Object.keys(retornosPreco);

  for (const ano of anos) {
    retornosTotalBRL[ano] = [];
    // Yield mensal = yield anual / 12
    const yieldMensal = yieldAnual / 12;

    for (let mes = 0; mes < 12; mes++) {
      const retPreco = retornosPreco[ano][mes] || 0;
      const retDolar = retornosDolar[ano]?.[mes] || 0;

      // Retorno total em USD = variação de preço + dividendo mensal
      // (1 + ret_preco) * (1 + yield_mensal) - 1
      const retTotalUSD = ((1 + retPreco/100) * (1 + yieldMensal/100) - 1) * 100;

      // Converter para BRL
      const retTotalBRL = ((1 + retTotalUSD/100) * (1 + retDolar/100) - 1) * 100;
      retornosTotalBRL[ano].push(parseFloat(retTotalBRL.toFixed(2)));
    }
  }

  return retornosTotalBRL;
}

const sp500BRL = calcularSP500TotalReturnBRL(sp500Retornos, dolarRetornos, SP500_DIVIDEND_YIELD);

// Função especial para TLT: inclui dividendos reinvestidos (Total Return)
// Fórmula: (1 + variação_preço) * (1 + dividendo_mensal) * (1 + variação_dólar) - 1
function calcularTLTTotalReturnBRL(retornosPreco, retornosDolar, yieldAnual) {
  const retornosTotalBRL = {};
  const anos = Object.keys(retornosPreco);

  for (const ano of anos) {
    retornosTotalBRL[ano] = [];
    // Yield mensal = yield anual / 12
    const yieldMensal = (yieldAnual[ano] || 3.5) / 12;

    for (let mes = 0; mes < 12; mes++) {
      const retPreco = retornosPreco[ano][mes] || 0;
      const retDolar = retornosDolar[ano]?.[mes] || 0;

      // Retorno total em USD = variação de preço + dividendo mensal
      // (1 + ret_preco) * (1 + yield_mensal) - 1
      const retTotalUSD = ((1 + retPreco/100) * (1 + yieldMensal/100) - 1) * 100;

      // Converter para BRL
      const retTotalBRL = ((1 + retTotalUSD/100) * (1 + retDolar/100) - 1) * 100;
      retornosTotalBRL[ano].push(parseFloat(retTotalBRL.toFixed(2)));
    }
  }

  return retornosTotalBRL;
}

// TLT com retorno total (preço + dividendos + câmbio)
const tltBRL = calcularTLTTotalReturnBRL(tltRetornos, dolarRetornos, tltYieldAnual);

// Gerar array de meses
const meses = [];
const mesesNomes = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];

for (let ano = 2005; ano <= 2025; ano++) {
  for (let mes = 0; mes < 12; mes++) {
    const anoStr = ano.toString();
    meses.push({
      periodo: `${mesesNomes[mes]}/${ano}`,
      ano: ano,
      mes: mes + 1,
      inflacao_ipca: ipca[anoStr]?.[mes] || 0,
      cdi: cdi[anoStr]?.[mes] || 0,
      selic_meta: selicMeta[anoStr]?.[mes] || 0,
      ibovespa: ibovRetornos[anoStr]?.[mes] || 0,
      dolar: dolarRetornos[anoStr]?.[mes] || 0,
      ouro: ouroBRL[anoStr]?.[mes] || 0,
      sp500_brl: sp500BRL[anoStr]?.[mes] || 0,
      tlt_brl: tltBRL[anoStr]?.[mes] || 0,
      bitcoin_brl: btcBRL[anoStr]?.[mes] || 0,
      fii_ifix: ifix[anoStr]?.[mes] || 0,
      imoveis_fipezap: imoveisFipezap[anoStr]?.[mes] || 0,
      ibovtr: ibovtrRetornos[anoStr]?.[mes] || 0,
      idiv: idivRetornos[anoStr]?.[mes] || 0,
      imab5: imab5Retornos[anoStr]?.[mes] || 0
    });
  }
}

// Criar estrutura final
const dadosMensais = {
  versao: "2.0",
  tipo: "mensal",
  atualizacao: new Date().toISOString().split('T')[0],
  meses: meses
};

// Salvar arquivo
const outputPath = path.join(__dirname, '..', 'data', 'historico-mensal.json');
fs.mkdirSync(path.dirname(outputPath), { recursive: true });
fs.writeFileSync(outputPath, JSON.stringify(dadosMensais, null, 2));

console.log(`Arquivo gerado: ${outputPath}`);
console.log(`Total de meses: ${meses.length}`);
console.log(`Período: ${meses[0].periodo} a ${meses[meses.length-1].periodo}`);
